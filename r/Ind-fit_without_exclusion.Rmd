---
title: "Ind-fit_without_exclusion"
output: html_document
---
```{r}

#make the four bins: 
metadataPlot <- metadata %>%group_by(subject) %>% 
mutate(trial_number = row_number()) %>%
group_by(subject) #create a trial number column
  
#split in the four bins according to task 
metadataPlot <- metadataPlot %>%
    group_by(modality) %>%
    mutate(trial_bin = ntile(trial_number, n = 4)) 
  
#Summarise means for each bin and modality
metadataPlotMean <- metadataPlot %>%
group_by(trial_bin, modality) %>%
summarise(mean.acc = mean(accuracy),
          sd.acc = sd(accuracy), n.acc = n_distinct(subject)) %>%
mutate(se.acc = sd.acc / sqrt(n.acc),
         lower.ci.acc = mean.acc - qt(1 - (0.05 / 2), n.acc - 1) * se.acc,
         upper.ci.acc = mean.acc + qt(1 - (0.05 / 2), n.acc - 1) * se.acc) %>%
ungroup()


#Average confidence across domains, split by correct and incorrect trials
#split by correct and incorrect:
tmp_data <- metadata  %>%
   mutate(accuracy = factor(accuracy)) %>%
  mutate(accuracy = recode_factor(accuracy, '1' = "Hits", '0' = "Misses"))

#Average confidence for Correct trials:
ConfByError <- tmp_data  %>%
  group_by(subject, modality, accuracy) %>% 
  summarise(avgCF_Corr=mean(confidence, na_rm=TRUE)) 
```

